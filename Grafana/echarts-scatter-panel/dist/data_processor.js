"use strict";System.register(["lodash","./time_series2","./colors","jquery","jquery.flot"],function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h,i;return{setters:[function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a["default"]},function(a){}],execute:function(){h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),a("DataProcessor",i=function(){function a(b){c(this,a),this.panel=b}return h(a,[{key:"getSeriesList",value:function(a){var b=this;if(!a.dataList||0===a.dataList.length)return[];var c;if(a.dataList&&a.dataList.length>0){c=a.dataList[0];var e=this.getAutoDetectXAxisMode(c);this.panel.xaxis.mode!==e&&(this.panel.xaxis.mode=e,this.setPanelDefaultsForNewXAxisMode())}switch(this.panel.xaxis.mode){case"series":case"time":return a.dataList.map(function(c,d){return b.timeSeriesHandler(c,d,a)});case"histogram":var f=[{target:"count",datapoints:d.concat([],d.flatten(d.map(a.dataList,"datapoints")))}];return f.map(function(c,d){return b.timeSeriesHandler(c,d,a)});case"field":return this.customHandler(c)}}},{key:"getAutoDetectXAxisMode",value:function(a){switch(a.type){case"docs":return"field";case"table":return"field";default:return"series"===this.panel.xaxis.mode?"series":"histogram"===this.panel.xaxis.mode?"histogram":"time"}}},{key:"setPanelDefaultsForNewXAxisMode",value:function(){switch(this.panel.xaxis.mode){case"time":this.panel.bars=!1,this.panel.lines=!0,this.panel.points=!1,this.panel.legend.show=!0,this.panel.tooltip.shared=!0,this.panel.xaxis.values=[];break;case"series":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1,this.panel.xaxis.values=["total"];break;case"histogram":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1}}},{key:"timeSeriesHandler",value:function(a,b,c){var d=a.datapoints||[],g=a.target,h=b%f.length,i=this.panel.aliasColors[g]||f[h],j=new e({datapoints:d,alias:g,color:i,unit:a.unit});if(d&&d.length>0){var k=d[d.length-1][1],l=c.range.from;k-l<-1e4&&(j.isOutsideRange=!0)}return j}},{key:"customHandler",value:function(a){var b=this.panel.xaxis.name;if(!b)throw{message:"No field name specified to use for x-axis, check your axes settings"};return[]}},{key:"validateXAxisSeriesValue",value:function(){switch(this.panel.xaxis.mode){case"series":if(0===this.panel.xaxis.values.length)return void(this.panel.xaxis.values=["total"]);var a=this.getXAxisValueOptions({}),b=d.find(a,{value:this.panel.xaxis.values[0]});return void(b||(this.panel.xaxis.values=["total"]))}}},{key:"getDataFieldNames",value:function(a,b){function c(a){d.forEach(a,function(a,f){if(d.isObject(a))g.push(f),c(a);else if(!b||d.isNumber(a)){var h=g.concat(f).join(".");e.push(h)}}),g.pop()}if(0===a.length)return[];var e=[],f=a[0],g=[];if("docs"===f.type){if(0===f.datapoints.length)return[];c(f.datapoints[0])}return e}},{key:"getXAxisValueOptions",value:function(a){switch(this.panel.xaxis.mode){case"series":return[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"}]}return[]}},{key:"pluckDeep",value:function(a,b){for(var c=b.split("."),d=a,e=0;e<c.length;++e){if(!d[c[e]])return;d=d[c[e]]}return d}}]),a}()),a("DataProcessor",i)}}});
//# sourceMappingURL=data_processor.js.map